import math

# ----------------------
# Константи
# ----------------------
M = 13                 # Розмір таблиці
A = (math.sqrt(5) - 1) / 2  # Константа для методу множення
WORDS = ["ЛЮДИНА", "БЕЗ", "ДРУЗІВ", "ЯК", "ДЕРЕВО", "БЕЗ", "КОРІННЯ"]

LETTER_POSITIONS = {
    'А': 1, 'Б': 2, 'В': 3, 'Г': 4, 'Д': 5, 'Е': 6, 'Є': 7, 'Ж': 8, 'З': 9,
    'И': 10, 'І': 11, 'Ї': 12, 'Й': 13, 'К': 14, 'Л': 15, 'М': 16, 'Н': 17,
    'О': 18, 'П': 19, 'Р': 20, 'С': 21, 'Т': 22, 'У': 23, 'Ф': 24, 'Х': 25,
    'Ц': 26, 'Ч': 27, 'Ш': 28, 'Щ': 29, 'Ь': 30, 'Ю': 31, 'Я': 32
}

# ----------------------
# Функція обчислення числового ключа
# ----------------------
def key_from_word(word):
    return sum(LETTER_POSITIONS.get(c.upper(), 0) for c in word)

# ----------------------
# Хеш-функції
# ----------------------
def hash_division(k):
    return k % M

def hash_multiplication(k):
    return int(16 * ((k * A) % 1))  # floor(16*(k*A mod 1))

# ----------------------
# Закрита хеш-таблиця (відкрита адресація, linear probing)
# ----------------------
def build_closed_hash_table(words, hash_func):
    table = [None] * M
    print("\n--- Побудова закритої хеш-таблиці ---")
    for word in words:
        k = key_from_word(word)
        idx = hash_func(k)
        start_idx = idx
        steps = 0
        while table[idx] is not None:
            idx = (idx + 1) % M
            steps += 1
            if idx == start_idx:
                raise Exception("Таблиця переповнена!")
        table[idx] = word
        print(f"Слово '{word}' (ключ={k}) → індекс {idx} (кроків пошуку {steps})")
    return table

def display_closed_table(table):
    print("\n--- Закрита хеш-таблиця ---")
    for i, word in enumerate(table):
        print(f"Індекс {i:02d}: {word}")

# ----------------------
# Виконання
# ----------------------
print("\n=== Метод ділення ===")
closed_table_div = build_closed_hash_table(WORDS, hash_division)
display_closed_table(closed_table_div)

print("\n=== Метод множення ===")
closed_table_mul = build_closed_hash_table(WORDS, hash_multiplication)
display_closed_table(closed_table_mul)
